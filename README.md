# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Мамонтов Александр`


### Задание 1.

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер;
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed - replicated block device (DRBD);
- SAN-кластер.

1. активный master-сервер и пассивный репликационный slave-сервер. Активный узел выполняет запросы, а пассивный ждет отказа и включается в работу, когда таковой произойдет. Не самый отказоустойчивый, но самый распространенный варинт. При правильной настройке данная конфигурация позволяет с минимальным простоем продолжить обслуживаение клиентов. Все операции и чтение и запись берет на себя master, в то время как slave по большей части используется для резервирования.
2. master-сервер и несколько slave-серверов. Самый рациональный вариант масштарибрования с точки зрения отказоустойчивости. Несколько slave-серверов позволяется распределять нагрузку на БД. Тоесть master может использоваться только для записи, один slave используется для чтения пользователем, другой slave используется для аналитики. При этом как и в перовом варианте один из slave может стать master при отказе последним, имя свой активный slave.
3. активный сервер со специальным механизмом репликации — distributed - replicated block device (DRBD). Основная функциональность DRBD реализована с помощью ядра Linux. Оно отражает содержимое блочных устройств, таких как жесткие диски, разделы, логические тома и т.д. между серверами. Оно создает копии данных на двух устройствах хранения для того, чтобы в случае сбоя одного из них можно было использовать данные на втором. Из-за чего DRBD чрезвычайно гибок и универсален, что делает его решением для репликации хранилища, подходящим для добавления практически в любое приложение.
4. SAN-кластер. Основные преимущества: экономия дисковых ресурсов, простое управление дисковыми устройствами, повышение производительности дисковых устройств, независимость от трафика LAN или WAN-сетей, возможность резервирования данных без загрузки локальной сети и серверов, высокое быстродействие, масштабируемость и отказоустойчивость, возможность живой миграции виртуальных машин.

### Задание 2. 

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц:

- пользователи,
- книги,
- магазины (столбцы произвольно).

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

План:

1. Используется СУБД PostgreSQL. Осуществлена настройка синхронной репликации между двумя серверами по принципу активный master-сервер и пассивный репликационный slave-сервер. Данный подход позволит сэкономить на оборудовании, а также обеспечить достаточную отказоустойчивость системы.
2. Создадим N-е количество горизонтальных партции согласно наших данных. Каждая дочерняя таблица будет наследоваться от Store и содержать информацию об id_user и id_book относящихся к конкретному магазину. Количество горизонтальных партиции будет соответствовать количеству магазинов.
3. В перспективе, если в БД будет добавлены таблицы, содержащие информацию о платежах, то можно создать дополнительные горизонтальные партиции, с проверкой платежей на отдельный месяц или квартал.

Дополнительно. 
В случае, если данные перестанут умещаться в рамках системы, или нужно ускорить выполнение запросов при работе с большим объемом данных, то можно настроить шардирование.
К примеру, если платежей будет большое количество и данные собирались уже несколько лет, то можно дополнительно настроить третий slave-сервер, и создать новые БД, к примеру payment_2022 и payment_2023. Каждая БД будет отвечать за платежи осуществленные в определенный год. Для реализации данной структуры используем обертку `postgres_fdw`.


![Скриншот-1](https://github.com/Zzeting/relationbd-hw-5/blob/main/img/1.PNG)


